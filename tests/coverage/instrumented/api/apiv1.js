
var __cov_wemJQuNdmcro4OzHx3MnNQ = (Function('return this'))();
if (!__cov_wemJQuNdmcro4OzHx3MnNQ.__coverage__) { __cov_wemJQuNdmcro4OzHx3MnNQ.__coverage__ = {}; }
__cov_wemJQuNdmcro4OzHx3MnNQ = __cov_wemJQuNdmcro4OzHx3MnNQ.__coverage__;
if (!(__cov_wemJQuNdmcro4OzHx3MnNQ['api/apiv1.js'])) {
   __cov_wemJQuNdmcro4OzHx3MnNQ['api/apiv1.js'] = {"path":"api/apiv1.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":34}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":32}},"4":{"start":{"line":5,"column":0},"end":{"line":7,"column":2}},"5":{"start":{"line":9,"column":0},"end":{"line":10,"column":102}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":25}},"7":{"start":{"line":13,"column":0},"end":{"line":23,"column":1}},"8":{"start":{"line":14,"column":1},"end":{"line":16,"column":54}},"9":{"start":{"line":17,"column":1},"end":{"line":22,"column":2}},"10":{"start":{"line":25,"column":0},"end":{"line":46,"column":1}},"11":{"start":{"line":26,"column":1},"end":{"line":26,"column":16}},"12":{"start":{"line":27,"column":1},"end":{"line":27,"column":21}},"13":{"start":{"line":28,"column":1},"end":{"line":45,"column":2}},"14":{"start":{"line":35,"column":3},"end":{"line":42,"column":4}},"15":{"start":{"line":36,"column":4},"end":{"line":36,"column":47}},"16":{"start":{"line":37,"column":10},"end":{"line":42,"column":4}},"17":{"start":{"line":38,"column":4},"end":{"line":38,"column":20}},"18":{"start":{"line":39,"column":4},"end":{"line":39,"column":44}},"19":{"start":{"line":41,"column":4},"end":{"line":41,"column":37}},"20":{"start":{"line":43,"column":3},"end":{"line":43,"column":50}},"21":{"start":{"line":48,"column":0},"end":{"line":58,"column":1}},"22":{"start":{"line":49,"column":1},"end":{"line":49,"column":28}},"23":{"start":{"line":51,"column":1},"end":{"line":53,"column":2}},"24":{"start":{"line":52,"column":2},"end":{"line":52,"column":69}},"25":{"start":{"line":55,"column":1},"end":{"line":55,"column":67}},"26":{"start":{"line":56,"column":1},"end":{"line":56,"column":49}},"27":{"start":{"line":57,"column":1},"end":{"line":57,"column":49}},"28":{"start":{"line":60,"column":0},"end":{"line":71,"column":1}},"29":{"start":{"line":61,"column":1},"end":{"line":61,"column":26}},"30":{"start":{"line":62,"column":1},"end":{"line":62,"column":26}},"31":{"start":{"line":64,"column":1},"end":{"line":66,"column":2}},"32":{"start":{"line":65,"column":2},"end":{"line":65,"column":72}},"33":{"start":{"line":68,"column":1},"end":{"line":68,"column":63}},"34":{"start":{"line":69,"column":1},"end":{"line":69,"column":55}},"35":{"start":{"line":70,"column":1},"end":{"line":70,"column":49}},"36":{"start":{"line":73,"column":0},"end":{"line":73,"column":45}},"37":{"start":{"line":74,"column":0},"end":{"line":74,"column":65}},"38":{"start":{"line":76,"column":0},"end":{"line":76,"column":23}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":3},"end":{"line":35,"column":3}},{"start":{"line":35,"column":3},"end":{"line":35,"column":3}}]},"2":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":10},"end":{"line":37,"column":10}},{"start":{"line":37,"column":10},"end":{"line":37,"column":10}}]},"3":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},{"start":{"line":51,"column":1},"end":{"line":51,"column":1}}]},"4":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},{"start":{"line":64,"column":1},"end":{"line":64,"column":1}}]},"5":{"line":64,"type":"binary-expr","locations":[{"start":{"line":64,"column":5},"end":{"line":64,"column":22}},{"start":{"line":64,"column":26},"end":{"line":64,"column":43}}]}}};
}
__cov_wemJQuNdmcro4OzHx3MnNQ = __cov_wemJQuNdmcro4OzHx3MnNQ['api/apiv1.js'];
__cov_wemJQuNdmcro4OzHx3MnNQ.s['1']++;const express=require('express');__cov_wemJQuNdmcro4OzHx3MnNQ.s['2']++;const router=express.Router();__cov_wemJQuNdmcro4OzHx3MnNQ.s['3']++;var REQUEST=require('request');__cov_wemJQuNdmcro4OzHx3MnNQ.s['4']++;var request=REQUEST.defaults({strictSSL:false});__cov_wemJQuNdmcro4OzHx3MnNQ.s['5']++;const WEATHER_API='http://api.openweathermap.org/data/2.5/weather?appid=6b7b471967dd0851d0010cdecf28f829&units=metric';__cov_wemJQuNdmcro4OzHx3MnNQ.s['6']++;const COUNTRY_CODE='NZ';__cov_wemJQuNdmcro4OzHx3MnNQ.s['7']++;const getWeatherConditions=weatherReport=>{__cov_wemJQuNdmcro4OzHx3MnNQ.s['8']++;const weather=`Conditions are ${weatherReport.weather[0].main}`+` and temperature is ${weatherReport.main.temp} C`;__cov_wemJQuNdmcro4OzHx3MnNQ.s['9']++;return{city:weatherReport.name,weather:weather,lng:weatherReport.coord.lon,lat:weatherReport.coord.lat};};__cov_wemJQuNdmcro4OzHx3MnNQ.s['10']++;const sendApiRequest=(res,weatherApiQuery,failureMsg)=>{__cov_wemJQuNdmcro4OzHx3MnNQ.s['11']++;let respPayload;__cov_wemJQuNdmcro4OzHx3MnNQ.s['12']++;let statusCode=400;__cov_wemJQuNdmcro4OzHx3MnNQ.s['13']++;request({method:'GET',url:weatherApiQuery,json:true},(err,resp,body)=>{__cov_wemJQuNdmcro4OzHx3MnNQ.s['14']++;if(err){__cov_wemJQuNdmcro4OzHx3MnNQ.b['1'][0]++;__cov_wemJQuNdmcro4OzHx3MnNQ.s['15']++;respPayload={msg:'Failed to get data'};}else{__cov_wemJQuNdmcro4OzHx3MnNQ.b['1'][1]++;__cov_wemJQuNdmcro4OzHx3MnNQ.s['16']++;if(body.cod===200){__cov_wemJQuNdmcro4OzHx3MnNQ.b['2'][0]++;__cov_wemJQuNdmcro4OzHx3MnNQ.s['17']++;statusCode=200;__cov_wemJQuNdmcro4OzHx3MnNQ.s['18']++;respPayload=getWeatherConditions(body);}else{__cov_wemJQuNdmcro4OzHx3MnNQ.b['2'][1]++;__cov_wemJQuNdmcro4OzHx3MnNQ.s['19']++;respPayload={msg:failureMsg};}}__cov_wemJQuNdmcro4OzHx3MnNQ.s['20']++;return res.status(statusCode).send(respPayload);});};__cov_wemJQuNdmcro4OzHx3MnNQ.s['21']++;exports.getWeather=(req,res)=>{__cov_wemJQuNdmcro4OzHx3MnNQ.s['22']++;const city=req.query.city;__cov_wemJQuNdmcro4OzHx3MnNQ.s['23']++;if(city===undefined){__cov_wemJQuNdmcro4OzHx3MnNQ.b['3'][0]++;__cov_wemJQuNdmcro4OzHx3MnNQ.s['24']++;return res.status(400).send({msg:'no "city" paramter provided'});}else{__cov_wemJQuNdmcro4OzHx3MnNQ.b['3'][1]++;}__cov_wemJQuNdmcro4OzHx3MnNQ.s['25']++;const weatherApiQuery=`${WEATHER_API}&q=${city},${COUNTRY_CODE}`;__cov_wemJQuNdmcro4OzHx3MnNQ.s['26']++;const failureMsg=`No weather data for ${city}`;__cov_wemJQuNdmcro4OzHx3MnNQ.s['27']++;sendApiRequest(res,weatherApiQuery,failureMsg);};__cov_wemJQuNdmcro4OzHx3MnNQ.s['28']++;exports.getWeatherWithCoords=(req,res)=>{__cov_wemJQuNdmcro4OzHx3MnNQ.s['29']++;const lat=req.query.lat;__cov_wemJQuNdmcro4OzHx3MnNQ.s['30']++;const lon=req.query.lng;__cov_wemJQuNdmcro4OzHx3MnNQ.s['31']++;if((__cov_wemJQuNdmcro4OzHx3MnNQ.b['5'][0]++,lat===undefined)||(__cov_wemJQuNdmcro4OzHx3MnNQ.b['5'][1]++,lon===undefined)){__cov_wemJQuNdmcro4OzHx3MnNQ.b['4'][0]++;__cov_wemJQuNdmcro4OzHx3MnNQ.s['32']++;return res.status(400).send({msg:'no "lat" and/or "lng" provided'});}else{__cov_wemJQuNdmcro4OzHx3MnNQ.b['4'][1]++;}__cov_wemJQuNdmcro4OzHx3MnNQ.s['33']++;const weatherApiQuery=`${WEATHER_API}&lat=${lat}&lon=${lon}`;__cov_wemJQuNdmcro4OzHx3MnNQ.s['34']++;const failureMsg=`No weather data for ${lat} ${lon}`;__cov_wemJQuNdmcro4OzHx3MnNQ.s['35']++;sendApiRequest(res,weatherApiQuery,failureMsg);};__cov_wemJQuNdmcro4OzHx3MnNQ.s['36']++;router.get('/getWeather',exports.getWeather);__cov_wemJQuNdmcro4OzHx3MnNQ.s['37']++;router.get('/getWeatherWithCoords',exports.getWeatherWithCoords);__cov_wemJQuNdmcro4OzHx3MnNQ.s['38']++;exports.router=router;
